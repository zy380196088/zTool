{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;;AAEA,QAAQ,UAAR,GAAqB,IAArB;;AAEA,QAAQ,OAAR,GAAkB,UAAU,IAAV,EAAgB;AAChC,MAAI,OAAO,KAAK,IAAhB;AAAA,MACI,SAAS,KAAK,MADlB;AAAA,MAEI,QAAQ,KAAK,KAFjB;AAAA,MAGI,KAAK,KAAK,EAHd;;AAKA,MAAI,KAAK,EAAT,EAAa;;AAEb,MAAI,CAAC,EAAE,gBAAF,CAAmB,MAAnB,KAA8B,EAAE,cAAF,CAAiB,MAAjB,EAAyB,EAAE,MAAM,QAAR,EAAzB,CAA/B,MAAiF,CAAC,OAAO,QAAR,IAAoB,EAAE,SAAF,CAAY,OAAO,GAAnB,CAArG,CAAJ,EAAmI;AACjI,SAAK,OAAO,GAAZ;AACD,GAFD,MAEO,IAAI,EAAE,oBAAF,CAAuB,MAAvB,CAAJ,EAAoC;AACzC,SAAK,OAAO,EAAZ;;AAEA,QAAI,EAAE,YAAF,CAAe,EAAf,CAAJ,EAAwB;AACtB,UAAI,UAAU,MAAM,MAAN,CAAa,UAAb,CAAwB,GAAG,IAA3B,CAAd;AACA,UAAI,WAAW,QAAQ,QAAnB,IAA+B,MAAM,UAAN,CAAiB,GAAG,IAApB,MAA8B,OAAjE,EAA0E;AACxE,aAAK,EAAL,GAAU,EAAV;AACA,aAAK,EAAL,CAAQ,EAAE,iBAAV,IAA+B,IAA/B;AACA;AACD;AACF;AACF,GAXM,MAWA,IAAI,EAAE,sBAAF,CAAyB,MAAzB,CAAJ,EAAsC;AAC3C,SAAK,OAAO,IAAZ;AACD,GAFM,MAEA,IAAI,CAAC,EAAL,EAAS;AACd;AACD;;AAED,MAAI,OAAO,KAAK,CAAhB;AACA,MAAI,MAAM,EAAE,SAAF,CAAY,EAAZ,CAAV,EAA2B;AACzB,WAAO,GAAG,KAAV;AACD,GAFD,MAEO,IAAI,MAAM,EAAE,YAAF,CAAe,EAAf,CAAV,EAA8B;AACnC,WAAO,GAAG,IAAV;AACD,GAFM,MAEA;AACL;AACD;;AAED,SAAO,EAAE,uBAAF,CAA0B,IAA1B,CAAP;AACA,OAAK,EAAE,UAAF,CAAa,IAAb,CAAL;;AAEA,KAAG,EAAE,iBAAL,IAA0B,IAA1B;;AAEA,MAAI,QAAQ,MAAM,IAAN,EAAY,IAAZ,EAAkB,KAAlB,CAAZ;AACA,SAAO,KAAK,KAAL,EAAY,IAAZ,EAAkB,EAAlB,EAAsB,KAAtB,KAAgC,IAAvC;AACD,CA3CD;;AA6CA,IAAI,+BAA+B,QAAQ,iCAAR,CAAnC;;AAEA,IAAI,gCAAgC,uBAAuB,4BAAvB,CAApC;;AAEA,IAAI,iBAAiB,QAAQ,gBAAR,CAArB;;AAEA,IAAI,kBAAkB,uBAAuB,cAAvB,CAAtB;;AAEA,IAAI,cAAc,QAAQ,aAAR,CAAlB;;AAEA,IAAI,IAAI,wBAAwB,WAAxB,CAAR;;AAEA,SAAS,uBAAT,CAAiC,GAAjC,EAAsC;AAAE,MAAI,OAAO,IAAI,UAAf,EAA2B;AAAE,WAAO,GAAP;AAAa,GAA1C,MAAgD;AAAE,QAAI,SAAS,EAAb,CAAiB,IAAI,OAAO,IAAX,EAAiB;AAAE,WAAK,IAAI,GAAT,IAAgB,GAAhB,EAAqB;AAAE,YAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,GAArC,EAA0C,GAA1C,CAAJ,EAAoD,OAAO,GAAP,IAAc,IAAI,GAAJ,CAAd;AAAyB;AAAE,KAAC,OAAO,OAAP,GAAiB,GAAjB,CAAsB,OAAO,MAAP;AAAgB;AAAE;;AAE7Q,SAAS,sBAAT,CAAgC,GAAhC,EAAqC;AAAE,SAAO,OAAO,IAAI,UAAX,GAAwB,GAAxB,GAA8B,EAAE,SAAS,GAAX,EAArC;AAAwD;;AAE/F,IAAI,uCAAuC,CAAC,GAAG,gBAAgB,OAApB,EAA6B,+PAA7B,CAA3C;;AAEA,IAAI,gDAAgD,CAAC,GAAG,gBAAgB,OAApB,EAA6B,wQAA7B,CAApD;;AAEA,IAAI,UAAU;AACZ,4CAA0C,SAAS,qCAAT,CAA+C,IAA/C,EAAqD,KAArD,EAA4D;AACpG,QAAI,KAAK,IAAL,CAAU,IAAV,KAAmB,MAAM,IAA7B,EAAmC;;AAEnC,QAAI,cAAc,KAAK,KAAL,CAAW,oBAAX,CAAgC,MAAM,IAAtC,CAAlB;AACA,QAAI,gBAAgB,MAAM,WAA1B,EAAuC;;AAEvC,UAAM,aAAN,GAAsB,IAAtB;AACA,SAAK,IAAL;AACD;AATW,CAAd;;AAYA,SAAS,IAAT,CAAc,KAAd,EAAqB,MAArB,EAA6B,EAA7B,EAAiC,KAAjC,EAAwC;AACtC,MAAI,MAAM,aAAV,EAAyB;AACvB,QAAI,MAAM,UAAN,CAAiB,GAAG,IAApB,KAA6B,CAAC,MAAM,SAAN,CAAgB,GAAG,IAAnB,CAAlC,EAA4D;AAC1D,YAAM,MAAN,CAAa,GAAG,IAAhB;AACD,KAFD,MAEO;AACL,UAAI,CAAC,EAAE,UAAF,CAAa,MAAb,CAAL,EAA2B;;AAE3B,UAAI,QAAQ,oCAAZ;AACA,UAAI,OAAO,SAAX,EAAsB,QAAQ,6CAAR;AACtB,UAAI,YAAY,MAAM;AACpB,kBAAU,MADU;AAEpB,qBAAa,EAFO;AAGpB,sBAAc,MAAM,qBAAN,CAA4B,GAAG,IAA/B;AAHM,OAAN,EAIb,UAJH;AAKA,gBAAU,MAAV,CAAiB,iBAAjB,GAAqC,IAArC;;AAEA,UAAI,SAAS,UAAU,MAAV,CAAiB,IAAjB,CAAsB,IAAtB,CAA2B,CAA3B,EAA8B,MAA3C;AACA,WAAK,IAAI,IAAI,CAAR,EAAW,MAAM,CAAC,GAAG,8BAA8B,OAAlC,EAA2C,MAA3C,CAAtB,EAA0E,IAAI,GAA9E,EAAmF,GAAnF,EAAwF;AACtF,eAAO,IAAP,CAAY,MAAM,qBAAN,CAA4B,GAA5B,CAAZ;AACD;;AAED,aAAO,SAAP;AACD;AACF;;AAED,SAAO,EAAP,GAAY,EAAZ;AACA,QAAM,gBAAN,GAAyB,UAAzB,CAAoC,GAAG,IAAvC,IAA+C,IAA/C;AACD;;AAED,SAAS,KAAT,CAAe,IAAf,EAAqB,IAArB,EAA2B,KAA3B,EAAkC;AAChC,MAAI,QAAQ;AACV,oBAAgB,KADN;AAEV,mBAAe,KAFL;AAGV,iBAAa,MAAM,oBAAN,CAA2B,IAA3B,CAHH;AAIV,gBAAY,EAJF;AAKV,UAAM;AALI,GAAZ;;AAQA,MAAI,UAAU,MAAM,aAAN,CAAoB,IAApB,CAAd;;AAEA,MAAI,OAAJ,EAAa;AACX,QAAI,QAAQ,IAAR,KAAiB,OAArB,EAA8B;AAC5B,YAAM,aAAN,GAAsB,IAAtB;AACD,KAFD,MAEO,CAAE;AACV,GAJD,MAIO,IAAI,MAAM,WAAN,IAAqB,MAAM,SAAN,CAAgB,IAAhB,CAAzB,EAAgD;AACrD,UAAM,QAAN,CAAe,IAAf,EAAqB,OAArB,EAA8B,KAA9B;AACD;;AAED,SAAO,KAAP;AACD;;AAED,OAAO,OAAP,GAAiB,QAAQ,SAAR,CAAjB","file":"index-compiled.js","sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (_ref) {\n  var node = _ref.node,\n      parent = _ref.parent,\n      scope = _ref.scope,\n      id = _ref.id;\n\n  if (node.id) return;\n\n  if ((t.isObjectProperty(parent) || t.isObjectMethod(parent, { kind: \"method\" })) && (!parent.computed || t.isLiteral(parent.key))) {\n    id = parent.key;\n  } else if (t.isVariableDeclarator(parent)) {\n    id = parent.id;\n\n    if (t.isIdentifier(id)) {\n      var binding = scope.parent.getBinding(id.name);\n      if (binding && binding.constant && scope.getBinding(id.name) === binding) {\n        node.id = id;\n        node.id[t.NOT_LOCAL_BINDING] = true;\n        return;\n      }\n    }\n  } else if (t.isAssignmentExpression(parent)) {\n    id = parent.left;\n  } else if (!id) {\n    return;\n  }\n\n  var name = void 0;\n  if (id && t.isLiteral(id)) {\n    name = id.value;\n  } else if (id && t.isIdentifier(id)) {\n    name = id.name;\n  } else {\n    return;\n  }\n\n  name = t.toBindingIdentifierName(name);\n  id = t.identifier(name);\n\n  id[t.NOT_LOCAL_BINDING] = true;\n\n  var state = visit(node, name, scope);\n  return wrap(state, node, id, scope) || node;\n};\n\nvar _babelHelperGetFunctionArity = require(\"babel-helper-get-function-arity\");\n\nvar _babelHelperGetFunctionArity2 = _interopRequireDefault(_babelHelperGetFunctionArity);\n\nvar _babelTemplate = require(\"babel-template\");\n\nvar _babelTemplate2 = _interopRequireDefault(_babelTemplate);\n\nvar _babelTypes = require(\"babel-types\");\n\nvar t = _interopRequireWildcard(_babelTypes);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar buildPropertyMethodAssignmentWrapper = (0, _babelTemplate2.default)(\"\\n  (function (FUNCTION_KEY) {\\n    function FUNCTION_ID() {\\n      return FUNCTION_KEY.apply(this, arguments);\\n    }\\n\\n    FUNCTION_ID.toString = function () {\\n      return FUNCTION_KEY.toString();\\n    }\\n\\n    return FUNCTION_ID;\\n  })(FUNCTION)\\n\");\n\nvar buildGeneratorPropertyMethodAssignmentWrapper = (0, _babelTemplate2.default)(\"\\n  (function (FUNCTION_KEY) {\\n    function* FUNCTION_ID() {\\n      return yield* FUNCTION_KEY.apply(this, arguments);\\n    }\\n\\n    FUNCTION_ID.toString = function () {\\n      return FUNCTION_KEY.toString();\\n    };\\n\\n    return FUNCTION_ID;\\n  })(FUNCTION)\\n\");\n\nvar visitor = {\n  \"ReferencedIdentifier|BindingIdentifier\": function ReferencedIdentifierBindingIdentifier(path, state) {\n    if (path.node.name !== state.name) return;\n\n    var localDeclar = path.scope.getBindingIdentifier(state.name);\n    if (localDeclar !== state.outerDeclar) return;\n\n    state.selfReference = true;\n    path.stop();\n  }\n};\n\nfunction wrap(state, method, id, scope) {\n  if (state.selfReference) {\n    if (scope.hasBinding(id.name) && !scope.hasGlobal(id.name)) {\n      scope.rename(id.name);\n    } else {\n      if (!t.isFunction(method)) return;\n\n      var build = buildPropertyMethodAssignmentWrapper;\n      if (method.generator) build = buildGeneratorPropertyMethodAssignmentWrapper;\n      var _template = build({\n        FUNCTION: method,\n        FUNCTION_ID: id,\n        FUNCTION_KEY: scope.generateUidIdentifier(id.name)\n      }).expression;\n      _template.callee._skipModulesRemap = true;\n\n      var params = _template.callee.body.body[0].params;\n      for (var i = 0, len = (0, _babelHelperGetFunctionArity2.default)(method); i < len; i++) {\n        params.push(scope.generateUidIdentifier(\"x\"));\n      }\n\n      return _template;\n    }\n  }\n\n  method.id = id;\n  scope.getProgramParent().references[id.name] = true;\n}\n\nfunction visit(node, name, scope) {\n  var state = {\n    selfAssignment: false,\n    selfReference: false,\n    outerDeclar: scope.getBindingIdentifier(name),\n    references: [],\n    name: name\n  };\n\n  var binding = scope.getOwnBinding(name);\n\n  if (binding) {\n    if (binding.kind === \"param\") {\n      state.selfReference = true;\n    } else {}\n  } else if (state.outerDeclar || scope.hasGlobal(name)) {\n    scope.traverse(node, visitor, state);\n  }\n\n  return state;\n}\n\nmodule.exports = exports[\"default\"];"]}